!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.Xiuli=n()}(this,function(){"use strict";var t="undefined"!=typeof Float32Array?Float32Array:Array;function n(t){for(var n=getComputedStyle(t,null),e={},r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return i.forEach(function(t){var r=n.getPropertyValue("-webkit-"+t)||n.getPropertyValue("-moz-"+t)||n.getPropertyValue("-ms-"+t)||n.getPropertyValue("-o-"+t)||n.getPropertyValue(""+t)||"none";e[t]=r}),e}function e(n,e,r){var i=new t(3);return i[0]=n,i[1]=e,i[2]=r,i}function r(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return n[12]=t[0],n[13]=t[1],n[14]=t[2],n}function i(n,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new t(16),i=n[0],a=n[1],o=n[2],s=n[3],u=n[4],l=n[5],h=n[6],c=n[7],f=n[8],d=n[9],v=n[10],m=n[11],y=n[12],p=n[13],g=n[14],b=n[15],k=e[0],w=e[1],x=e[2],F=e[3];return r[0]=k*i+w*u+x*f+F*y,r[1]=k*a+w*l+x*d+F*p,r[2]=k*o+w*h+x*v+F*g,r[3]=k*s+w*c+x*m+F*b,k=e[4],w=e[5],x=e[6],F=e[7],r[4]=k*i+w*u+x*f+F*y,r[5]=k*a+w*l+x*d+F*p,r[6]=k*o+w*h+x*v+F*g,r[7]=k*s+w*c+x*m+F*b,k=e[8],w=e[9],x=e[10],F=e[11],r[8]=k*i+w*u+x*f+F*y,r[9]=k*a+w*l+x*d+F*p,r[10]=k*o+w*h+x*v+F*g,r[11]=k*s+w*c+x*m+F*b,k=e[12],w=e[13],x=e[14],F=e[15],r[12]=k*i+w*u+x*f+F*y,r[13]=k*a+w*l+x*d+F*p,r[14]=k*o+w*h+x*v+F*g,r[15]=k*s+w*c+x*m+F*b,r}function a(n,e,r){var i,a,o,s,u,l,h,c,f,d,v,m,y,p,g,b,k,w,x,F,M,I,A,T,E=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new t(16),P=r[0],S=r[1],j=r[2],V=Math.sqrt(P*P+S*S+j*j);return Math.abs(V)<1e-6?null:(P*=V=1/V,S*=V,j*=V,i=Math.sin(e),o=1-(a=Math.cos(e)),s=n[0],u=n[1],l=n[2],h=n[3],c=n[4],f=n[5],d=n[6],v=n[7],m=n[8],y=n[9],p=n[10],g=n[11],b=P*P*o+a,k=S*P*o+j*i,w=j*P*o-S*i,x=P*S*o-j*i,F=S*S*o+a,M=j*S*o+P*i,I=P*j*o+S*i,A=S*j*o-P*i,T=j*j*o+a,E[0]=s*b+c*k+m*w,E[1]=u*b+f*k+y*w,E[2]=l*b+d*k+p*w,E[3]=h*b+v*k+g*w,E[4]=s*x+c*F+m*M,E[5]=u*x+f*F+y*M,E[6]=l*x+d*F+p*M,E[7]=h*x+v*F+g*M,E[8]=s*I+c*A+m*T,E[9]=u*I+f*A+y*T,E[10]=l*I+d*A+p*T,E[11]=h*I+v*A+g*T,n!==E&&(E[12]=n[12],E[13]=n[13],E[14]=n[14],E[15]=n[15]),E)}function o(n){var e=n.split(/\(|\)|, |\s/g),r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return"matrix"===e[0]?(r[0]=parseFloat(e[1]),r[1]=parseFloat(e[2]),r[4]=parseFloat(e[3]),r[5]=parseFloat(e[4]),r[12]=parseFloat(e[5]),r[13]=parseFloat(e[6])):"matrix3d"===e[0]&&function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new t(16);e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]}(e.slice(1,17).map(function(t){return parseFloat(t)}),r),r}function s(t){return"matrix3d("+t.join(",")+")"}var u=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")},l=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),h=function(){return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,n){var e=[],r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(e.push(o.value),!n||e.length!==n);r=!0);}catch(t){i=!0,a=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return e}(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(){function a(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"xiuli",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;u(this,a),this.main=document.getElementById(e),this.main.style.position="absolute",this.main.style.transformStyle="preserve-3d","0s"===n(this.main,"transition","transition-duration")["transition-duration"]&&(this.main.style.transitionDuration="2s",this.main.style.WebkitTransitionDuration="2s"),this.root=this.main.parentElement,this.callback=null,this.data=null,this.main.addEventListener("transitionend",function(){t.callback&&(t.callback(t.elementIds[t.current],t.data),t.data=null)},!1),this.mainTrans=o(n(this.main,"transform").transform),this.init(r)}return l(a,[{key:"init",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;this.TFun=n,this.elementIds=[],this.current=-1,this.elements={},this.xiulies=this.main.querySelectorAll("[data-xiuli]"),this.TFun instanceof Function&&Array.prototype.forEach.call(this.xiulies,function(n,e,r){var i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];i=t.TFun(i,e,r),n.style.transform=s(i)}),Array.prototype.forEach.call(this.xiulies,function(n,e){var r=!1;0===e&&(r=!0),t.add(n,r)})}},{key:"add",value:function(a,u){var l=n(a,"transform","transform-origin"),c=l.transform,f=l["transform-origin"].match(/[-+]?[0-9]*\.?[0-9]+/g),d=h(f,3),v=d[0],m=void 0===v?0:v,y=d[1],p=void 0===y?0:y,g=d[2],b=void 0===g?0:g,k=o(c),w=e(m,p,b),x=r(w);i(x,k,k),function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new t(3);e[0]=-n[0],e[1]=-n[1],e[2]=-n[2]}(w,w);var F=this.root.offsetWidth,M=this.root.offsetHeight;w[0]-=(F-a.offsetWidth)/2,w[1]-=(M-a.offsetHeight)/2,r(w,x),i(k,x,k),function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new t(16),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],u=n[5],l=n[6],h=n[7],c=n[8],f=n[9],d=n[10],v=n[11],m=n[12],y=n[13],p=n[14],g=n[15],b=r*u-i*s,k=r*l-a*s,w=r*h-o*s,x=i*l-a*u,F=i*h-o*u,M=a*h-o*l,I=c*y-f*m,A=c*p-d*m,T=c*g-v*m,E=f*p-d*y,P=f*g-v*y,S=d*g-v*p,j=b*S-k*P+w*E+x*T-F*A+M*I;j&&(j=1/j,e[0]=(u*S-l*P+h*E)*j,e[1]=(a*P-i*S-o*E)*j,e[2]=(y*M-p*F+g*x)*j,e[3]=(d*F-f*M-v*x)*j,e[4]=(l*T-s*S-h*A)*j,e[5]=(r*S-a*T+o*A)*j,e[6]=(p*w-m*M-g*k)*j,e[7]=(c*M-d*w+v*k)*j,e[8]=(s*P-u*T+h*I)*j,e[9]=(i*T-r*P-o*I)*j,e[10]=(m*F-y*w+g*b)*j,e[11]=(f*w-c*F-v*b)*j,e[12]=(u*A-s*E-l*I)*j,e[13]=(r*E-i*A+a*I)*j,e[14]=(y*k-m*x-p*b)*j,e[15]=(c*x-f*k+d*b)*j)}(k,k),i(this.mainTrans,k,k),this.elements[a.id]=s(k),this.elementIds.push(a.id),u&&this.goto(a.id,null)}},{key:"onTransitionend",value:function(t){this.callback=t}},{key:"goto",value:function(t,n){var e=this.elementIds.indexOf(t);-1!==e&&(this.main.style.transform=this.elements[t],this.data=n,this.current=e)}},{key:"pre",value:function(t){this.current-=1,this.current<0&&(this.current=this.elementIds.length-1);var n=this.elementIds[this.current];this.goto(n,t)}},{key:"next",value:function(t){this.current+=1,this.current>=this.elementIds.length&&(this.current=0);var n=this.elementIds[this.current];this.goto(n,t)}}]),a}();var f=Object.freeze({steps:function(t,n){var e=t;return e[12]=600,e[13]=-400*n,e[14]=-400*n,e},circular:function(t,n){var e=6.28319*n/6,r=t;return r[12]=600*Math.sin(e),r[13]=200,r[14]=800*(Math.cos(e)-1),r},spiralSteps:function(t,n,r){var i=t,o=6.28319*n/r.length;return a(t,o-1.5708,e(0,1,0),t),i[12]=500*Math.sin(o),i[13]=-400*n,i[14]=500*(Math.cos(o)-1),i},spiralRotated:function(t,n){var r=t,i=6.28319*n/6;return a(t,i,e(0,1,0),t),r[12]=600*Math.sin(i),r[13]=200*n,r[14]=600*(Math.cos(i)-1),t},poly:function(t,n){var r=t,i=6.28319*n/6;return a(t,i,e(0,1,0),t),r[12]=600*Math.sin(i),r[13]=200,r[14]=600*(Math.cos(i)-1),t}});return c.initializers=f,c});
//# sourceMappingURL=xiuli.min.js.map
